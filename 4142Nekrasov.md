---
title-page: ./t.pdf
toc: true
toc-title: Содержание
---

# ТЕХНИЧЕСКОЕ ЗАДАНИЕ

Итоговый продукт должен улучшать качество входящих изображений. Входные данные: изображения. Выходные данные: изображение более высокого качества.

# ВЫБОР СПОСОБА РЕАЛИЗАЦИИ

Итоговый продукт будет представлен в виде сервиса, реализующего API, получающее на вход изображение, отдающее на выходе исходное изображение с улучшенным качеством. Сервис будет написан на языке python с использованием библиотек tensorflow и flask.

# ОПИСАНИЕ РЕАЛИЗАЦИИ

Реализация проекта происходит в несколько этапов:

1. Написание сервиса, реализующего API
2. Формирование дата сета;
3. Обучение модели;
4. Проверка работоспособности на изображениях из датасета;
5. Проверка работоспособности на произвольных изображениях;

# РАЗРАБОТКА СЕРВИСА

Для начала был разработан сервис, реализующий API /upscale, которое принимает файл в формате form-data в поле image и возвращает улучшенное изображение.

На листингах 1 и 2 представлен код сервиса: модули model.py, представляющий собой модель, которая будет осуществлять улучшение качества изображения, и server.py, представляющий собой точку входа приложения, запускающую flask сервер, принимающий POST запрос по пути /upscale, прогоняющий изображение через модель и возвращающий ответ пользователю.

~~~{.py include=./project/model.py caption="код модели"}
~~~

~~~{.py include=./project/server.py caption="код сервера"}
~~~

На рисунках 1 и 2 представлена демонстрация работы сервиса на нетренированной модели:

![Отправка запроса](img/demo.png)

![Пример входных и выходных данных для сервиса с нетренированной моделью](img/untrained_in_out.png)

# ДАТАСЕТ

Для создания датасета был сделан скрипт, который для каждого изображения из директории original_images создаёт изображения с качеством в 5, 10, 30, 50 и 70 процентов от изначального.

На листинге 3 представлен код этого скрипта.

~~~{.bash include=./project/generate_dataset.sh caption="Код генератора датасета"}
~~~

![Генерация датасета](img/dataset.png)

# ОБУЧЕНИЕ

Для обучения модели также был написан скрипт. Данный скрипт, код которого представлен в листинге 4, загружает датасет, проходя по каждому изображению из директории со сжатыми изображениями, находит его оригинал в директории с оригинальными изображениями и сохраняет их в массивы X и Y, которые позже загружает в модель для её тренировки. После тренировки модель сохраняется в файл.


~~~{.py include=./project/train.py caption="скрипт тренировки"}
~~~

![Процесс обучения](img/training.png)

# ПРОВЕРКА РАБОТОСПОСОБНОСТИ НА ИЗОБРАЖЕНИЯХ ИЗ ДАТАСЕТА

На рисунках 5-15 представлены примеры работы сервиса на изображении из датасета с разным разрешением.

![Исходное изображение](./project/result_images/sent_pexels-96281476-9258933_compressed_20.jpg) ![Результат](./project/result_images/result_pexels-96281476-9258933_compressed_20.jpg)

![Исходное изображение](./project/result_images/sent_pexels-pincalo-15030820_compressed_10.jpg) ![Результат](./project/result_images/result_pexels-pincalo-15030820_compressed_10.jpg)

![Исходное изображение](./project/result_images/sent_pexels-brandaohh-3183678_compressed_10.jpg) ![Результат](./project/result_images/result_pexels-brandaohh-3183678_compressed_10.jpg)

![Исходное изображение](./project/result_images/sent_pexels-julioneryy-1839919_compressed_30.jpg) ![Результат](./project/result_images/result_pexels-julioneryy-1839919_compressed_30.jpg)

![Исходное изображение](./project/result_images/sent_pexels-leo-pekaar-4848842-6469198_compressed_30.jpg) ![Результат](./project/result_images/result_pexels-leo-pekaar-4848842-6469198_compressed_30.jpg)

# ПРОВЕРКА РАБОТОСПОСОБНОСТИ НА ПРОИЗВОЛЬНЫХ ИЗОБРАЖЕНИЯХ

На рисунках 16-20 представлены примеры работы сервиса на изображениях не из датасета.

![Исходное изображение](./output_image.jpg) ![Результат](./isaac_cathedral_enh.jpg)

![Исходное изображение](./output_image1.jpg) ![Результат](./enh1.jpg)

Невооружённым глазом заметить разницу сложно, но если приглядеться, изменения очень заметны:

![Разница между исходным и результирующим изображением вблизи](img/diff.png)

# ЗАКЛЮЧЕНИЕ

В ходе работы над проектом “Сервис для улучшения качества изображений на базе нейросети” был разработан сервис, составлена модель и натренерована нейронная сеть. Исходный код доступен по ссылке: https://github.com/goodhumored/image_upscale. Итоговый продукт может улучшать качество изображений. Чтобы улучшить работу сети, необходимо дообучить её на более объемном датасете.

# СПИСОК ИСПОЛЬЗУЕМЫХ ИСТОЧНИКОВ

1. Документация tensorflow [Электронный ресурс]. URL:

https://www.tensorflow.org/api_docs

2. Документация keras [Электронный ресурс]. URL: 

https://keras.io/api/

3. Репозиторий бесплатных изображений Pexels [Электронный ресурс]. URL:

https://www.tensorflow.org/

